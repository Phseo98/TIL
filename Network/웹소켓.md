# WebSoket

카메라 RTSP 받아 브라우저에 랜더링을 하고싶어 기능 구현을 하다가 WebSoket은 왜 사용하는 것인지 궁금해 정리한다.

## WebSoket 탄생

웹소켓의 탄생에는 HTTP의 한계 때문이다.

### HTTP의 한계

HTTP 프로토콜의 초기 목적은 단순 문서 전달이었다.

하지만 인터넷이 발전하면서 문서 전달 이상의 것을 웹에서 하기를 원했고 그중 하나가 실시간 통신이다.

예를 들어 온라인게임, 실시간채팅, 주식차트 전달 같은 것이다.

<hr/>

### 클라이언트의 요청있어야 응답이 가능

이런 실시간 정보를 제공하는데에는 HTTP프로토콜의 한계가 존재한다.

HTTP 프로토콜은 클라이언트가 요청 시 서버가 응답하는 단방향 구조이다.

즉 클라이언트의 요청이 없으면 서버에서 먼저 데이터를 주지 못한다.

예를 들어 서버에서 브라우저에게 채팅 메세지를 보내고 싶을때 클라이언트 요청없이는 전달할 수가 없다.

이 방식을 해결하기 위해 HTTP에서 long polling, streaming 방식을 사용 했지만 이 방법도
한계가 있음.

<hr/>

### 비효율적인 HandShake

HTTP 통신은 한번의 요청에 각각 HandShake가 발생해 많은 오버헤드가 발생함.

통신이 많은 HTTP 방법은 실시간통신에 적합하지 않음.

<br />
<br />

## WebSoket이란

웹소켓이란 HTTP 처럼 서버와 클라이언트간의 통신을 할수 있는 프로토콜의 종류다.

웹소켓은 서버와 클라이언트 간의 Soket Connection을 유지해 언제든 양방향 통신 또는 데이터 전송이 가능하게 해준다.

## WebSoket 사용이유

HTTP를 사용하지 않고 웹소켓을 사용하는 이유에는 크게 3가지가 있다.

1. 양방향통신 : HTTP는 클라이언트가 서버에 요청을 해야만 서버가 응답을 할수 있지만, 웹 소켓은 클라이언트의 요청이 없어도 브라우저에 데이터를 전달 할수있음.

2. 적은오버헤드 : HTTP는 각 요청마다 서버와 연결을해야함(오버헤드 증가), 웹소켓 통신은 한번 연결되면 유지할수있음(오버헤드 감소)

3. 서버푸시 : HTTP는 클라이언트의 요청이 있어야만 서버에서 응답할 수 있음, 웹소켓은 언제든 클라이언트에게 데이터전달기 가능함

## WebSoket 상호작용

웹소켓의 통신방식은 클라이언트가 서버에 HTTP 요청을 서버로 보낸다.

그후 웹소켓 통신이 연결되면, 서버와 클라이언트 양쪽에서 데이터를 전달할 수 있다.

웹소켓 Interactive과정은 다음과 같다.

1. 클라이언트와 서버 HandShake(HTTP UPGRADE) - 연결
2. 연결 후 Bidirectional Messages(양방향 메세지) - 연결지속
3. 클라이언트와 서버가 한쪽만 연결을 닫아도 종료 - 연결종료
