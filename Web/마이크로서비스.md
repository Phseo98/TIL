# 마이크로 서비스

마이크로서비스 아키텍쳐는 독립적으로 수행되는 소규모 시스템들이 명확하고 절대적으로 분리된 인터페이스 정의에 의해 긴밀하기 통신하는 아키텍처 기반의 접근구현 방식이다.

쉽게 말해 서비스별로 분리하여 독립적으로 수행하고, 분리된 서비스들이 모여 대규모 서비스를 제공하는 방식이다.

기존 시스템들은 하나의 시스템 안에서 모든 서비스를 제공하는 모놀리식(Monolith)기법으로 구현됬다.

예를 들어 한 시스템안에서 다양한 서비스(기능)들이 모두 동작하고 있는 형태이고, 마이크로서비스는 서비스(기능)마다 개별적으로 DB가 동작하는 형태이다.

마이크로서비스의 핵심은 독립적인 서비스이고, 독립적인 서비스는 다른 서비스가 장애가 생겨도 동작할 수 있는 시스템이여 한다.

## 모놀로식 아키텍처

모놀리식 아키텍처는 모든 구성요소가 하나의 시스템에 통합되어 있는 형태로 설계되고, 배포, 실행도 한 서비스 내에서 이루어진다.

장점

- 단일서버와 단일 환경에서 서비스가 개발되고, 단일 개발 언어를 사용하기 때문에 하나의 코드 컨벤션만 유지하여 코드 품질이 좋아질 수 있다.
- 통합된 시스템이기 때문에 한꺼번에 모든 영역을 배포가 가능하다.
- 서비스가 단일 시스템에서 동작하기 때문에 시스템을 위한 서버, 네트워크,DB만 유지하면되서 운영비용이 적다.
- 시스템이 사용량이 늘어 서비스를 확장 해야 될 경우, 단일 시스템만 병렬로 추가(scale-out) 하면 되서 확장이 쉽다.

단점

- 단일 시스템에 모든 영역이 포함되어 있어 필요한 데이터를 쉽게 참조 할 수 있지만, 시간이 지나 참조영역이 많아지면 의존성이 늘어나 이해할 수 없을 정도로 참조 관계가 뒤섞인다.
- 첫번째 단점처럼 코드의 의존성이 늘어나 브랜치 작업의 안정성도 떨어지고, 배포도 정해진 시간에 맞춰 규직적으로 해야한다.
- 단일 개발을 사용해 코드품질을 높일수 있는 장점도 있지만 하나의 언어만 사용하기 때문에 기술 스택에 한계가 있다.
- 서버의 scale-up 한계의 상황에서 서버를 scale-out 해야 할 경우, 불필요 하게 모든 장비(CPU, SSD, 네트워크 등)를 구매해 서버를 구성해야 되기 때문에 경제적으로 확장이 쉽지 않다. (서비스마다 메모리가 부족한지, CPU가 부족한지 다 다르기 떄문)

## 마이크로 서비스 아키텍처

마이크로 서비스 아키텍처는 모놀리식 아키텍처를 개선하고자 등장했다.

모놀리식 서비스 규모가 늘어나면서 갖은 단점들이 나타나게 되면서, 서비스 분리에 대한 필요성이 나타났다.

마이크로 서비스는 서비스끼리 완전히 독립된 형태이고 서비스들 끼리 의존성도 낮은 형태이다.

장점

- 서비스 별로 나눠져 있기 때문에 업무에 대한 집중도가 높아 신속한 대응이 가능하다.
- 서비스가 작기 때문에 코드를 이해하기 쉽고, 서비스 끼리 의존성도 적기 때문에 테스트 양과 범위가 상대적으로 적어 테스트도 쉽다.
- 낮은 의존성 덕분에 배포하기도 쉽고 브랜치로 작업하기도 용이하고, 장애가 발생해도 쉽게 찾을 수 있다.
- 모놀로식 서비스는 서비스 확장을 위해 시스템을 확장 해야 했다면, 마이크로 서비스는 서비스 별로 분리되어있기 때문에 불필요한 리소스를 확장할 필요가 없어 경제적인 시스템 확장이 가능하다.
- 예를들어서 상품, 주문, 배송 서비스는 그대로지만 전시 서비스만 늘어나면 전시 서비스만 scale-out 하면된다
- 서비스 별 분리되어 규모가 작은 만큼 확장성과 개선하기도 쉽다.

단점

- MSA는 모놀로식과 다르게 서비스가 분산되어 있기 때문에 상대적으로 설계하기 복잡하고 어렵다
- 서비스가 분리되어 여러 DB를 사용하면 데이터 관리가 어렵고 DB컬럼에 join도 어려워진다.
- 각 서비스를 호출 할 때도 서비스마다 개별호출 해야한다.
- 예를들어 사용자 정보를 관리하는 서비스와 주문정보를 관리하는 서비스가 따로 있다면, 사용자의 주문정보를 확인하려면 두 서비스를 각각 호출해야 한다.
